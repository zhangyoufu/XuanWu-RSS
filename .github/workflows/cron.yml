on:
  push:
  schedule:
  - cron: '*/5 2,3,4 * * *'

jobs:
  cron:
    if: github.ref == 'refs/heads/master'
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - run: |
        git fetch --no-tags origin +refs/heads/gh-pages:refs/remotes/origin/gh-pages
    - uses: actions/setup-python@v1
      with:
        python-version: '3.x'
    - run: exec .github/cron.sh
      env:
        GITHUB_PERSONAL_ACCESS_TOKEN: ${{ secrets.GITHUB_PERSONAL_ACCESS_TOKEN }}
        WEIBO_USERNAME: ${{ secrets.WEIBO_USERNAME }}
        WEIBO_PASSWORD: ${{ secrets.WEIBO_PASSWORD }}
